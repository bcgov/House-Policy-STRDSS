<div class="title">Send Takedown Request</div>
<p-messages [(value)]="messages" [enableService]="false" [closable]="false"></p-messages>
<div *ngIf="!hideForm" class="sub-title">Complete the following fields to send a Takedown Request to an STR Platform
    representative.
    <br>
    <br>
    Takedown Requests for each platform are aggregated into a CSV file and sent to the platform at 11:50pm PST each day.
    You will receive an email confirmation of your request once the form is submitted. All fields are required except
    where stated.
</div>

<form *ngIf="!hideForm" [formGroup]="myForm" (ngSubmit)="onPreview()">
    <div class="form-group-row">
        <div class="form-group-row-col">
            <label for="lgId">Request Initiated by</label>
        </div>
        <div class="form-group-row-col">
            <p-dropdown [options]="initiatorsOptions" formControlName="lgId" placeholder="Select local government"
                id="lgId" name="lgId" [required]="true"></p-dropdown>
        </div>
        <div class="form-group-row-col validation-errors" *ngIf="!lgIdControl.pristine && lgIdControl.errors">
            <small id="requiredLgIdControl" *ngIf="lgIdControl.errors?.['required']">Request initiator is
                required</small>
        </div>
    </div>

    <div class="form-group-row">
        <div class="form-group-row-col">
            <label for="platformId">Select a Platform Representative for</label>
        </div>
        <div class="form-group-row-col">
            <p-dropdown [options]="platformOptions" formControlName="platformId" placeholder="Select platform"
                id="platformId" name="platformId" [required]="true"></p-dropdown>
        </div>
        <div class="form-group-row-col validation-errors"
            *ngIf="!platformIdControl.pristine && platformIdControl.errors">
            <small id="requiredPlatformId" *ngIf="platformIdControl.errors?.['required']">Platform recipient is
                required</small>
        </div>
    </div>

    <div class="form-group-row">
        <div class="form-group-row-col">
            <span class="info-tooltip"
                pTooltip="Copy and paste the external URL of the STR listing from the platform website."
                tooltipPosition="top" placeholder="Top"></span>
            <label for="listingUrl">Add URL of the short-term rental listing</label>
        </div>
        <div class="form-group-row-col">
            <input class="long-text-field" type="text" placeholder="Enter URL" pInputText formControlName="listingUrl"
                id="listingUrl" name="listingUrl" required />
        </div>
        <div class="form-group-row-col validation-errors"
            *ngIf="!listingUrlControl.pristine && listingUrlControl.errors">
            <small id="invalidUrl" *ngIf="listingUrlControl.errors?.['invalidUrl']">Please make sure the URL format that
                you have entered is correct</small>
            <small id="requiredUrl" *ngIf="listingUrlControl.errors?.['required']">Listing URL is required</small>
        </div>
    </div>

    <div class="form-group-row">
        <div class="form-group-row-col">
            <label for="listingId">Add the Listing ID of the short-term rental listing if known (optional)</label>
        </div>
        <div class="form-group-row-col">
            <input class="long-text-field" type="text" inputStyleClass="long-text-field" formControlName="listingId"
                placeholder="Enter Listing ID" pInputText formControlName="listingId" [maxlength]="25" id="listingId"
                name="listingId" />
        </div>
    </div>

    <div class="form-group-row">
        <div class="form-group-row-col">
            <span class="info-tooltip" pTooltip="Enter additional email addresses separated by commas."
                tooltipPosition="top" placeholder="Top"></span>
            <label for="ccList">Add any additional recipients to receive a confirmation of the request
                (optional)</label>
        </div>
        <div class="form-group-row-col">
            <textarea formControlName="ccList" placeholder="Enter email address" rows="1" cols="20" pInputTextarea
                id="ccList" name="ccList"></textarea>
        </div>
        <div class="form-group-row-col validation-errors" *ngIf="!ccListControl.pristine && ccListControl.errors">
            <small id="invalidCcList" *ngIf="ccListControl.errors?.['invalidEmailList']">Please make sure the email
                format you have entered is correct</small>
        </div>
    </div>

    <button type="submit" id="form-preview-btn" pButton pRipple [disabled]="!myForm.valid" label="Review"></button>
</form>

<p-dialog [modal]="true" id="preview-dialog" [closable]="false" header="Takedown Request" [(visible)]="isPreviewVisible"
    [style]="{width: '50vw'}">
    <p [innerText]="previewText">
    </p>
    <div class="actions">
        <button pButton name="submit-dialog-btn" id="submit-dialog-btn" (click)="onSubmit()">Submit</button>
        <button pButton name="cancel-dialog-btn" id="cancel-dialog-btn" class="outline-btn"
            (click)="onPreviewClose()">Cancel</button>
    </div>
</p-dialog>
<button *ngIf="hideForm" pButton id="return-home-btn" name="return-home-btn" (click)="onReturnHome()">Return
    Home</button>